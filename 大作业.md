# å¤§ä½œä¸š

## ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€ç›‘æ§åŠŸèƒ½

### 1. Docker éƒ¨ç½²ç›‘æ§åº”ç”¨

```bash
root@lln:~/lln-dazuoye# cat Dockerfile
FROM python:3.9
WORKDIR /app
COPY . .
RUN pip install flask paramiko
EXPOSE 5000
CMD ["python", "app.py"]
```

![image-20251129010717455](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129010717455.png)

```bash
root@lln:~/lln-dazuoye# cat docker-compose.yml
version: '3'
services:
  monitor:
    build: .
    ports:
      - "5000:5000"
    volumes:
      - ./data:/app/data
```

![image-20251129011139292](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129011139292.png)

### éªŒè¯

```bash
root@lln:~/lln-dazuoye# docker ps | grep monitor
c7eda53dc6d5   lln-dazuoye_monitor   "python app.py"   2 minutes ago   Up 2 minutes   0.0.0.0:5000->5000/tcp, :::5000->5000/tcp   lln-dazuoye_monitor_1
```

![image-20251129022208684](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129022208684.png)

### 2. Web ä¸»æœºç®¡ç†é¡µé¢

#### åˆ›å»ºapp.py

```bash
#æ·»åŠ ä¸»æœº
@app.route('/add_host', methods=['POST'])
def add_host():
    """æ·»åŠ æœåŠ¡å™¨ - å°±åƒç™»è®°ç—…äºº"""
    ip = request.form['ip']
    user = request.form['user']
    password = request.form['password']
    
    # è¯»å–ç°æœ‰æ•°æ®
    try:
        with open(DATA_FILE, 'r') as f:
            data = json.load(f)
    except:
        data = {'hosts': []}
    
    # æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
    for host in data['hosts']:
        if host['ip'] == ip:
            return 'æœåŠ¡å™¨å·²å­˜åœ¨ï¼<a href="/">è¿”å›é¦–é¡µ</a>'
    
    # æ·»åŠ æ–°æœåŠ¡å™¨
    data['hosts'].append({
        'ip': ip,
        'user': user,
        'password': password
    })
    
    # ä¿å­˜æ•°æ®
    with open(DATA_FILE, 'w') as f:
        json.dump(data, f)
    
    return 'æœåŠ¡å™¨æ·»åŠ æˆåŠŸï¼<a href="/">è¿”å›é¦–é¡µ</a>'

            
#åˆ é™¤ä¸»æœº 
@app.route('/delete_host', methods=['POST'])
def delete_host():
    """åˆ é™¤æœåŠ¡å™¨"""
    ip_to_delete = request.json['ip']
    
    try:
        with open(DATA_FILE, 'r') as f:
            data = json.load(f)
        
        # è¿‡æ»¤æ‰è¦åˆ é™¤çš„æœåŠ¡å™¨
        data['hosts'] = [host for host in data['hosts'] if host['ip'] != ip_to_delete]
        
        with open(DATA_FILE, 'w') as f:
            json.dump(data, f)
        
        return jsonify({'status': 'success'})
    except:
        return jsonify({'status': 'error'})
```

![image-20251129012309349](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129012309349.png)

![image-20251129012324057](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129012324057.png)

### éªŒè¯ï¼š

![image-20251129022324477](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129022324477.png)

![image-20251129022629511](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129022629511.png)

![image-20251129022705212](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129022705212.png)

### 3. æ•°æ®é‡‡é›†åŠŸèƒ½

```bash
def get_real_metrics(host):
    """çœŸå®è¿æ¥æœåŠ¡å™¨è·å–ç›‘æ§æ•°æ®"""
    try:
        print(f"ğŸ” å°è¯•è¿æ¥æœåŠ¡å™¨: {host['ip']}")
        
        # åˆ›å»ºSSHè¿æ¥
        ssh = paramiko.SSHClient()
        ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
        
        # è®¾ç½®è¿æ¥å‚æ•°
        ssh.connect(
            host['ip'], 
            username=host['user'], 
            password=host['password'], 
            timeout=10,
            banner_timeout=10
        )
        
        print(f"âœ… SSHè¿æ¥æˆåŠŸ: {host['ip']}")
        
        # è·å–CPUä½¿ç”¨ç‡ - ä½¿ç”¨æ›´å…¼å®¹çš„å‘½ä»¤
        stdin, stdout, stderr = ssh.exec_command("top -bn1 | grep 'Cpu(s)' | head -1")
        cpu_output = stdout.read().decode()
        
        cpu_used = "æœªçŸ¥"
        if 'Cpu(s)' in cpu_output:
            cpu_match = re.search(r'(\d+\.\d+)%? id', cpu_output)
            if cpu_match:
                cpu_idle = float(cpu_match.group(1))
                cpu_used = f"{100 - cpu_idle:.1f}%"
        else:
            # å¤‡ç”¨æ–¹æ³•ï¼šä½¿ç”¨ /proc/stat
            stdin, stdout, stderr = ssh.exec_command("head -n1 /proc/stat")
            cpu_line = stdout.read().decode()
            cpu_numbers = re.findall(r'\d+', cpu_line)
            if len(cpu_numbers) >= 8:
                total_time = sum(int(x) for x in cpu_numbers[1:8])
                idle_time = int(cpu_numbers[4])
                cpu_used = f"{(1 - idle_time/total_time) * 100:.1f}%" if total_time > 0 else "0%"
        
        # è·å–å†…å­˜ä½¿ç”¨ç‡ - ä½¿ç”¨æ›´ç®€å•çš„å‘½ä»¤
        stdin, stdout, stderr = ssh.exec_command("free | grep Mem:")
        mem_output = stdout.read().decode()
        
        mem_used = "æœªçŸ¥"
        mem_numbers = re.findall(r'\d+', mem_output)
        if len(mem_numbers) >= 2:
            total_mem = int(mem_numbers[0])
            used_mem = int(mem_numbers[1])
            mem_used = f"{(used_mem/total_mem)*100:.1f}%" if total_mem > 0 else "0%"
        
        ssh.close()
        print(f"âœ… æ•°æ®é‡‡é›†æˆåŠŸ: {host['ip']} - CPU: {cpu_used}, å†…å­˜: {mem_used}")
        return cpu_used, mem_used
        
    except Exception as e:
        print(f"âŒ è¿æ¥å¤±è´¥ {host['ip']}: {str(e)}")
        return "è¿æ¥å¤±è´¥", "è¿æ¥å¤±è´¥"
```

![image-20251129013308664](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129013308664.png)

![image-20251129013324299](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129013324299.png)

### éªŒè¯ï¼š

![image-20251129024132367](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129024132367.png)

### 4. æ•°æ®å­˜å‚¨

```bash
def save_history_data(metric):
    """ä¿å­˜å†å²æ•°æ®åˆ°CSVæ–‡ä»¶"""
    history_file = f"data/history_{metric['ip'].replace('.', '_')}.csv"
    file_exists = os.path.isfile(history_file)
    
    with open(history_file, 'a', newline='', encoding='utf-8') as f:
        writer = csv.writer(f)
        if not file_exists:
            writer.writerow(['æ—¶é—´', 'CPUä½¿ç”¨ç‡', 'å†…å­˜ä½¿ç”¨ç‡', 'çŠ¶æ€'])
        
        writer.writerow([
            datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
            metric['cpu'],
            metric['memory'], 
            metric.get('status', 'æ­£å¸¸')
        ])

```

![image-20251129013516397](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129013516397.png)

### éªŒè¯ï¼š

![image-20251129024207988](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129024207988.png)

### 5. ç›‘æ§æ•°æ®å±•ç¤º

```bash
@app.route('/api/monitor_data')
def get_monitor_data():
    """è·å–ç›‘æ§æ•°æ® - è¿™ä¸ªè·¯ç”±å‡½æ•°ä¹‹å‰ç¼ºå¤±äº†ï¼"""
    try:
        # è¯»å–æœåŠ¡å™¨åˆ—è¡¨
        with open(DATA_FILE, 'r') as f:
            hosts_data = json.load(f)
        
        metrics = []
        for host in hosts_data['hosts']:
            # ä½¿ç”¨çœŸå®çš„æ•°æ®é‡‡é›†
            cpu, memory = get_real_metrics(host)
            metric_data = {
                'ip': host['ip'],
                'cpu': cpu,
                'memory': memory,
                'status': 'æ­£å¸¸' if 'è¿æ¥å¤±è´¥' not in cpu else 'å¼‚å¸¸',
                'timestamp': datetime.datetime.now().strftime("%H:%M:%S")
            }
            metrics.append(metric_data)
            
            # ä¿å­˜å†å²æ•°æ®
            save_history_data(metric_data)
        
        # æ£€æŸ¥å‘Šè­¦
        alerts = check_alerts(metrics)
        
        return jsonify({
            'hosts': hosts_data['hosts'],
            'metrics': metrics,
            'alerts': alerts
        })
    except Exception as e:
        print(f"âŒ è·å–ç›‘æ§æ•°æ®é”™è¯¯: {e}")
        return jsonify({'hosts': [], 'metrics': [], 'alerts': []})

@app.route('/history/<ip>')
def show_history(ip):
    """æ˜¾ç¤ºå†å²æ•°æ®é¡µé¢"""
    history_file = f"data/history_{ip.replace('.', '_')}.csv"
    
    # è¯»å–å†å²æ•°æ®
    history_data = []
    if os.path.exists(history_file):
        with open(history_file, 'r', encoding='utf-8') as f:
            reader = csv.reader(f)
            next(reader)  # è·³è¿‡æ ‡é¢˜è¡Œ
            for row in reader:
                if len(row) >= 4:
                    history_data.append({
                        'time': row[0],
                        'cpu': row[1],
                        'memory': row[2],
                        'status': row[3]
                    })
    
    # åªæ˜¾ç¤ºæœ€è¿‘50æ¡è®°å½•
    recent_data = history_data[-50:]
```

![image-20251129013640614](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129013640614.png)

## ç¬¬äºŒé˜¶æ®µï¼šå¤šæœåŠ¡å™¨ç›‘æ§

```bash
    try:
        with open(DATA_FILE, 'r') as f:
            data = json.load(f)
    except:
        data = {'hosts': []}
    
    # æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
    for host in data['hosts']:
        if host['ip'] == ip:
            return 'æœåŠ¡å™¨å·²å­˜åœ¨ï¼<a href="/">è¿”å›é¦–é¡µ</a>'
    
    # æ·»åŠ æ–°æœåŠ¡å™¨
    data['hosts'].append({
        'ip': ip,
        'user': user,
        'password': password
        'added_time': datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    })
```

![image-20251129014524097](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129014524097.png)

### éªŒè¯ï¼š

```
#å¯ä»¥æ·»åŠ å¤šä¸ªä¸»æœºï¼Œåé¢ä¼šæˆåŠŸçš„ï¼ï¼ï¼
```

![image-20251129024651855](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129024651855.png)

```
æˆåŠŸï¼
```

![image-20251129030441145](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129030441145.png)

## ç¬¬ä¸‰é˜¶æ®µï¼šå®æ—¶åˆ·æ–°ä¸å¯è§†åŒ–

### 1. å®æ—¶è‡ªåŠ¨åˆ·æ–°

```bash
 // æ›´æ–°æ‰€æœ‰æ•°æ®
            function updateData() {
                fetch('/api/monitor_data')
                    .then(response => response.json())
                    .then(data => {
                        updateHostList(data.hosts);
                        updateMonitorTable(data.metrics);
                        updateCharts(data.metrics);
                        updateAlerts(data.alerts || []);
                    })
                    .catch(error => {
                        console.error('æ›´æ–°æ•°æ®å¤±è´¥:', error);
                    });
            }

            // æ›´æ–°æœåŠ¡å™¨åˆ—è¡¨
            function updateHostList(hosts) {
                const container = document.getElementById('host-list');
                if (hosts.length === 0) {
                    container.innerHTML = '<p>æš‚æ— æœåŠ¡å™¨ï¼Œè¯·åœ¨ä¸Šæ–¹æ·»åŠ æœåŠ¡å™¨ã€‚</p>';
                    return;
                }

                let html = '<table><tr><th>IPåœ°å€</th><th>ç”¨æˆ·å</th><th>æ“ä½œ</th></tr>';
                hosts.forEach(host => {
                    html += `<tr>
                        <td>${host.ip}</td>
                        <td>${host.user}</td>
                        <td>
                            <button class="btn btn-danger" onclick="deleteHost('${host.ip}')">åˆ é™¤</button>
                            <button class="btn btn-info" onclick="viewHistory('${host.ip}')">å†å²</button>
                        </td>
                    </tr>`;
                });
                html += '</table>';
                container.innerHTML = html;
            }

            // æ›´æ–°ç›‘æ§è¡¨æ ¼
            function updateMonitorTable(metrics) {
                const container = document.getElementById('monitor-data');
                if (metrics.length === 0) {
                    container.innerHTML = '<p>æš‚æ— ç›‘æ§æ•°æ®ã€‚</p>';
                    return;
                }

                let html = '<table><tr><th>æœåŠ¡å™¨IP</th><th>çŠ¶æ€</th><th>CPUä½¿ç”¨ç‡</th><th>å†…å­˜ä½¿ç”¨ç‡</th><th>æ£€æŸ¥æ—¶é—´</th></tr>';
                metrics.forEach(metric => {
                    const statusClass = metric.status === 'æ­£å¸¸' ? 'status-normal' : 'status-error';
                    html += `<tr>
                        <td>${metric.ip}</td>
                        <td class="${statusClass}">${metric.status}</td>
                        <td>${metric.cpu}</td>
                        <td>${metric.memory}</td>
                        <td>${metric.timestamp}</td>
                    </tr>`;
                });
                html += '</table>';
                container.innerHTML = html;
            }

            // æ›´æ–°å›¾è¡¨
            function updateCharts(metrics) {
                const ips = metrics.map(m => m.ip);
                const cpuData = metrics.map(m => {
                    const cpuStr = m.cpu.replace('%', '').replace('è¿æ¥å¤±è´¥', '0');
                    return parseFloat(cpuStr) || 0;
                });
                const memoryData = metrics.map(m => {
                    const memoryStr = m.memory.replace('%', '').replace('è¿æ¥å¤±è´¥', '0');
                    return parseFloat(memoryStr) || 0;
                });

                cpuChart.setOption({
                    xAxis: { data: ips },
                    series: [{ data: cpuData }]
                });

                memoryChart.setOption({
                    xAxis: { data: ips },
                    series: [{ data: memoryData }]
                });
            }

            // æ›´æ–°å‘Šè­¦ä¿¡æ¯
            function updateAlerts(alerts) {
                const container = document.getElementById('alerts-container');
                if (alerts.length === 0) {
                    container.innerHTML = '<div class="alert-success">âœ… ä¸€åˆ‡æ­£å¸¸ï¼Œæ‰€æœ‰æœåŠ¡å™¨è¿è¡Œè‰¯å¥½</div>';
                    return;
                }

                let html = '';
                alerts.forEach(alert => {
                    const alertClass = alert.level === 'danger' ? 'alert-danger' : 'alert-warning';
                    html += `<div class="${alertClass}">
                        <strong>${alert.type}</strong>: ${alert.message} (${alert.time})
                    </div>`;
                });
                container.innerHTML = html;
            }

            // åˆ é™¤æœåŠ¡å™¨
            function deleteHost(ip) {
                if (confirm('ç¡®å®šè¦åˆ é™¤æœåŠ¡å™¨ ' + ip + ' å—ï¼Ÿ')) {
                    fetch('/delete_host', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({ip: ip})
                    }).then(() => {
                        updateData(); // é‡æ–°åŠ è½½æ•°æ®
                    });
                }
            }

            // æŸ¥çœ‹å†å²æ•°æ®
            function viewHistory(ip) {
                window.open('/history/' + ip, '_blank');
            }

            // é¡µé¢åŠ è½½æ—¶ç«‹å³æ›´æ–°ï¼Œç„¶åæ¯5ç§’æ›´æ–°ä¸€æ¬¡
            updateData();
            setInterval(updateData, 5000);
```

![image-20251129014952085](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129014952085.png)

![image-20251129015002878](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129015002878.png)

![image-20251129015019614](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129015019614.png)

### éªŒè¯ï¼š

![image-20251129024753747](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129024753747.png)

### 2. å›¾è¡¨å¯è§†åŒ–

```bash
<!-- å¼•å…¥EChartså›¾è¡¨åº“ -->
        <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>

        <script>
            // åˆå§‹åŒ–å›¾è¡¨
            const cpuChart = echarts.init(document.getElementById('cpu-chart'));
            const memoryChart = echarts.init(document.getElementById('memory-chart'));

            // å›¾è¡¨åŸºç¡€é…ç½®
            const chartOption = {
                tooltip: {
                    trigger: 'axis',
                    formatter: '{b}: {c}%'
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: [],
                    axisLabel: {
                        rotate: 45
                    }
                },
                yAxis: {
                    type: 'value',
                    max: 100,
                    axisLabel: {
                        formatter: '{value}%'
                    }
                },
                series: [{
                    type: 'bar',
                    data: [],
                    itemStyle: {
                        color: function(params) {
                            // æ ¹æ®æ•°å€¼æ˜¾ç¤ºä¸åŒé¢œè‰²
                            const value = params.value;
                            if (value > 80) return '#ff4d4f';
                            if (value > 60) return '#faad14';
                            return '#52c41a';
                        }
                    }
                }]
            };

            cpuChart.setOption(chartOption);
            memoryChart.setOption(chartOption);
```

![image-20251129015107222](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129015107222.png)

### éªŒè¯ï¼š

![image-20251129030428745](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129030428745.png)

## ç¬¬å››é˜¶æ®µï¼šé«˜çº§åŠŸèƒ½

### **å‘Šè­¦åŠŸèƒ½**

```bash
def check_alerts(metrics):
    """æ£€æŸ¥å‘Šè­¦æ¡ä»¶"""
    alerts = []
    for metric in metrics:
        # å°è¯•æå–æ•°å­—å€¼
        cpu_str = metric['cpu'].replace('%', '').replace('è¿æ¥å¤±è´¥', '0')
        memory_str = metric['memory'].replace('%', '').replace('è¿æ¥å¤±è´¥', '0')
        
        try:
            cpu_value = float(cpu_str)
            memory_value = float(memory_str)
        except:
            cpu_value = 0
            memory_value = 0
        
        if cpu_value > 80:
            alerts.append({
                'type': 'âš ï¸ CPUå‘Šè­¦',
                'message': f"æœåŠ¡å™¨ {metric['ip']} CPUä½¿ç”¨ç‡è¿‡é«˜: {metric['cpu']}",
                'level': 'danger',
                'time': datetime.datetime.now().strftime("%H:%M:%S")
            })
        
        if memory_value > 85:
            alerts.append({
                'type': 'ğŸš¨ å†…å­˜å‘Šè­¦', 
                'message': f"æœåŠ¡å™¨ {metric['ip']} å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜: {metric['memory']}",
                'level': 'warning',
                'time': datetime.datetime.now().strftime("%H:%M:%S")
            })
    
    return alerts
```

![image-20251129015309858](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129015309858.png)

### éªŒè¯ï¼š

![image-20251129025156414](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129025156414.png)

![image-20251129030537733](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129030537733.png)

### **å†å²æ•°æ®æŸ¥è¯¢**

```bash
@app.route('/history/<ip>')
def show_history(ip):
    """æ˜¾ç¤ºå†å²æ•°æ®é¡µé¢"""
    history_file = f"data/history_{ip.replace('.', '_')}.csv"
    
    # è¯»å–å†å²æ•°æ®
    history_data = []
    if os.path.exists(history_file):
        with open(history_file, 'r', encoding='utf-8') as f:
            reader = csv.reader(f)
            next(reader)  # è·³è¿‡æ ‡é¢˜è¡Œ
            for row in reader:
                if len(row) >= 4:
                    history_data.append({
                        'time': row[0],
                        'cpu': row[1],
                        'memory': row[2],
                        'status': row[3]
                    })
    
    # åªæ˜¾ç¤ºæœ€è¿‘50æ¡è®°å½•
    recent_data = history_data[-50:]
    
    return f'''
    <html>
    <head>
        <title>å†å²æ•°æ® - {ip}</title>
        <style>
            body {{ font-family: Arial, sans-serif; margin: 20px; }}
            .back-btn {{ background: #007bff; color: white; padding: 10px 20px; 
                       text-decoration: none; border-radius: 5px; display: inline-block; margin-bottom: 20px; }}
            table {{ width: 100%; border-collapse: collapse; margin: 10px 0; }}
            th, td {{ border: 1px solid #ddd; padding: 8px; text-align: left; }}
            th {{ background-color: #f2f2f2; }}
        </style>
    </head>
    <body>
        <a href="/" class="back-btn">â† è¿”å›é¦–é¡µ</a>
        <h2>ğŸ“Š æœåŠ¡å™¨ {ip} å†å²æ•°æ®</h2>
        
        <table>
            <tr>
                <th>æ—¶é—´</th>
                <th>CPUä½¿ç”¨ç‡</th>
                <th>å†…å­˜ä½¿ç”¨ç‡</th>
                <th>çŠ¶æ€</th>
            </tr>
            {"".join(f'<tr><td>{data["time"]}</td><td>{data["cpu"]}</td><td>{data["memory"]}</td><td>{data["status"]}</td></tr>' 
                    for data in reversed(recent_data))}
        </table>
        
        <p>å…± {len(recent_data)} æ¡è®°å½•ï¼ˆæ˜¾ç¤ºæœ€è¿‘50æ¡ï¼‰</p>
    </body>
    </html>
    '''
```

![image-20251129015406070](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129015406070.png)

### éªŒè¯ï¼š

![image-20251129024826694](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129024826694.png)

### éªŒæ”¶æˆæœ

```bash
root@lln:~/lln-dazuoye# docker-compose up -d
Building monitor
Step 1/6 : FROM python:3.9
 ---> bcd3da597491
Step 2/6 : WORKDIR /app
 ---> Using cache
 ---> 2a1b87bfc24c
Step 3/6 : COPY . .
 ---> Using cache
 ---> aa2f4f2af0be
Step 4/6 : RUN pip install flask paramiko
 ---> Running in f00fe1b5c938
Collecting flask
  Downloading flask-3.1.2-py3-none-any.whl (103 kB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 103.3/103.3 kB 133.9 kB/s eta 0:00:00
Collecting paramiko
  Downloading paramiko-4.0.0-py3-none-any.whl (223 kB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 223.9/223.9 kB 54.0 kB/s eta 0:00:00
Collecting werkzeug>=3.1.0
  Downloading werkzeug-3.1.3-py3-none-any.whl (224 kB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 224.5/224.5 kB 20.3 kB/s eta 0:00:00
Collecting markupsafe>=2.1.1
  Downloading markupsafe-3.0.3-cp39-cp39-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (20 kB)
Collecting itsdangerous>=2.2.0
  Downloading itsdangerous-2.2.0-py3-none-any.whl (16 kB)
Collecting importlib-metadata>=3.6.0
  Downloading importlib_metadata-8.7.0-py3-none-any.whl (27 kB)
Collecting jinja2>=3.1.2
  Downloading jinja2-3.1.6-py3-none-any.whl (134 kB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 134.9/134.9 kB 24.8 kB/s eta 0:00:00
Collecting click>=8.1.3
  Downloading click-8.1.8-py3-none-any.whl (98 kB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 98.2/98.2 kB 22.8 kB/s eta 0:00:00
Collecting blinker>=1.9.0
  Downloading blinker-1.9.0-py3-none-any.whl (8.5 kB)
Collecting cryptography>=3.3
  Downloading cryptography-46.0.3-cp38-abi3-manylinux_2_34_x86_64.whl (4.5 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 4.5/4.5 MB 25.7 kB/s eta 0:00:00
Collecting pynacl>=1.5
  Downloading pynacl-1.6.1-cp38-abi3-manylinux_2_34_x86_64.whl (1.4 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 1.4/1.4 MB 30.3 kB/s eta 0:00:00
Collecting invoke>=2.0
  Downloading invoke-2.2.1-py3-none-any.whl (160 kB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 160.3/160.3 kB 25.2 kB/s eta 0:00:00
Collecting bcrypt>=3.2
  Downloading bcrypt-5.0.0-cp39-abi3-manylinux_2_34_x86_64.whl (278 kB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 278.2/278.2 kB 29.4 kB/s eta 0:00:00
Collecting cffi>=2.0.0
  Downloading cffi-2.0.0-cp39-cp39-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (216 kB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 216.5/216.5 kB 32.4 kB/s eta 0:00:00
Collecting typing-extensions>=4.13.2
  Downloading typing_extensions-4.15.0-py3-none-any.whl (44 kB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 44.6/44.6 kB 48.1 kB/s eta 0:00:00
Collecting zipp>=3.20
  Downloading zipp-3.23.0-py3-none-any.whl (10 kB)
Collecting pycparser
  Downloading pycparser-2.23-py3-none-any.whl (118 kB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 118.1/118.1 kB 26.8 kB/s eta 0:00:00
Installing collected packages: zipp, typing-extensions, pycparser, markupsafe, itsdangerous, invoke, click, blinker, bcrypt, werkzeug, jinja2, importlib-metadata, cffi, pynacl, flask, cryptography, paramiko
Successfully installed bcrypt-5.0.0 blinker-1.9.0 cffi-2.0.0 click-8.1.8 cryptography-46.0.3 flask-3.1.2 importlib-metadata-8.7.0 invoke-2.2.1 itsdangerous-2.2.0 jinja2-3.1.6 markupsafe-3.0.3 paramiko-4.0.0 pycparser-2.23 pynacl-1.6.1 typing-extensions-4.15.0 werkzeug-3.1.3 zipp-3.23.0
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv

[notice] A new release of pip is available: 23.0.1 -> 25.3
[notice] To update, run: pip install --upgrade pip
 ---> Removed intermediate container f00fe1b5c938
 ---> 8ea170b4285d
Step 5/6 : EXPOSE 5000
 ---> Running in 926322900fea
 ---> Removed intermediate container 926322900fea
 ---> 6885a7b44dc9
Step 6/6 : CMD ["python", "app.py"]
 ---> Running in c88e15d5b402
 ---> Removed intermediate container c88e15d5b402
 ---> 6321c27a3a4f
Successfully built 6321c27a3a4f
Successfully tagged lln-dazuoye_monitor:latest
WARNING: Image for service monitor was built because it did not already exist. To rebuild this image you must use `docker-compose build` or `docker-compose up --build`.
Creating lln-dazuoye_monitor_1 ... done
```

![image-20251129022051612](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129022051612.png)

![image-20251129022105341](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129022105341.png)



## å®éªŒæˆåŠŸ

![image-20251129030328914](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129030328914.png)

![image-20251129030338481](C:\Users\LLN\AppData\Roaming\Typora\typora-user-images\image-20251129030338481.png)



